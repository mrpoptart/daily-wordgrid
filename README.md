# Daily Word Grid (Boggle × Wordle)

A daily, deterministic, 5×5 word-finding game that blends the path-finding rules of Boggle with the daily cadence and shareability of Wordle.

## Goals
- Deliver a fun, fair, daily puzzle playable in < 3 minutes
- Deterministic board per day to enable global competition
- Simple onboarding via PocketBase Auth (or just username for now)
- Low-latency serverless backend on Vercel
- Clean, shared types and validation across frontend and backend

## Daily Flow (User Experience)
1. User opens the app and logs in (or plays anonymously if supported)
2. Sees today’s 5×5 letter board (deterministically generated)
3. Taps/drag-selects adjacent letters to form words (Boggle rules)
4. Submits the round; words and score are stored
5. Score is tied to the user and day; shareable for friendly competition

## Gameplay Rules (Boggle-like)
- Letters must be contiguous; each next letter must be adjacent (including diagonals)
- A tile may not be reused within the same word path
- Minimum word length: 4 letters
- Duplicate words per day do not score twice
- Dictionary validation is enforced server-side (SOWPODS dictionary)
- Scoring (default):
  - 4 letters: 1 point
  - 5 letters: 2 points
  - 6 letters: 3 points
  - 7 letters: 5 points
  - 8+ letters: 11 points

## Tech Stack
- Frontend: Next.js (App Router), React, TypeScript
- Hosting/Backend runtime: Vercel (serverless functions/Edge as appropriate)
- Backend/Database: PocketBase (SQLite-based backend as a service)
- UI: Tailwind CSS + headless primitives (e.g., Radix UI/shadcn/ui)
- Testing: Vitest (unit), React Testing Library (components)

## Architecture Overview

```
[ Client (React, Next.js) ]
        │  ▲
        │  │ (typed requests/responses via Zod)
        ▼  │
[ API Routes / Server Actions ]  —>  [ PocketBase ]
```

### Deterministic Daily Board
- Seeded by the calendar date plus a server-side salt to prevent spoofing
- Example approach:
  - `seed = SHA256(YYYY-MM-DD + BOARD_DAILY_SALT)`
  - Use a seeded PRNG to draw letters by frequency distribution
  - Persist only the seed and/or board for auditing; derive board on-demand

### Data Model (PocketBase Collections)
```
users (managed by PocketBase Auth)

games (collection)
- date (text, unique)
- seed (text)              # generated from date + salt
- letters (text)           # flattened 25-letter string

submissions (collection)
- user_id (text)
- date (text)
- words (json)            # array of submitted words
- score (number)
- created (autogenerated date)
```

### API Surface (planned)
- `GET /api/board?date=YYYY-MM-DD` → returns today’s board and metadata
- `POST /api/validate` → validates a proposed word path against the board
- `POST /api/submit` → stores words + final score for the authenticated user
- `GET /api/leaderboard?date=YYYY-MM-DD` → top scores for the day

### Health Check
- `GET /api/health` → returns `{ status: "ok", env: { hasPocketBaseUrl, ... } }`.

## Local Development

### Prerequisites
- Node.js 20+
- npm (or pnpm/yarn/bun)
- PocketBase executable (download from pocketbase.io)

### Setup

1. **Install Dependencies**
   ```bash
   git clone <this-repo>
   cd <repo>
   npm install
   ```

2. **Setup PocketBase**
   - Download PocketBase and place it in a `pb/` directory (or anywhere you prefer).
   - Run PocketBase: `./pocketbase serve`
   - Go to `http://127.0.0.1:8090/_/` to create an admin account.
   - Create collections:
     - `games`: `date` (text), `seed` (text), `letters` (text). Make it publicly readable, writable only by admin (or public for this demo).
     - `submissions`: `user_id` (text), `date` (text), `words` (json), `score` (number).

3. **Configure Environment**
   cp .env.example .env.local

   Add:
   ```
   NEXT_PUBLIC_POCKETBASE_URL="http://127.0.0.1:8090"
   ```

4. **Run App**
   ```bash
   npm run dev
   ```

   Open `http://localhost:3000`.

### Linting requirement (pre-commit and build)
- The repo enforces linting before builds and commits.
- Run locally before committing or opening a PR:
  - `npm run lint` (no warnings allowed)
  - `npm run typecheck`
- `npm run build` will fail if `npm run lint` fails.

## Testing
- Test runner: Vitest
- Components: @testing-library/react
- Server: unit tests for board generation, scoring, validation, and API handlers

Example commands:
```bash
npm test            # run unit tests
npm run test:watch  # watch mode
```

## Deployment
- Target: Vercel
- PocketBase: needs to be hosted somewhere (e.g. PocketHost, Fly.io, or a VPS).
- Configure `NEXT_PUBLIC_POCKETBASE_URL` in Vercel.

---

Questions, bugs, or ideas? Open an issue or start a discussion.
